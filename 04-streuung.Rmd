# Streuungsparameter, Schiefe und Wölbung {#streuung}

## Streuungsparameter

Lesen Sie dazu bitte Kapitel 3.2.3 von @zimmermann2014.

**Streuungsparameter** sind Maße der Variabilität einer Häufigkeitsverteilung. Uns interessieren hier v.a. **Spannweite**, **Quartilsabstand**, **Varianz und Standardabweichung** und **Variationskoeffizient**, weniger durchschnittliche absolute Abweichung, da wir leztere kaum in der Praxis sehen.

Spannweite und Quartilsabstand lassen sich am besten mit einem sogenannten Box-Whisker-Plot, kurz einfach **Boxplot**, verdeutlichen (Abbildung \@ref(fig:boxplot)). Ein Boxplot fasst die Verteilung der Werte eines Merkmals (in einer Stichprobe) zusammen. Die **Spannweite** ist der Abstand zwischen Minimum und Maximum der Merkmalswerte. Der **Quartilsabstand** ist der Abstand zwischen 0.25-Quantil und 0.75-Quantil; in diesem Bereich liegen 50% der Merkmalswerte (0.75-0.25). 0.25-Quantil, 0.5-Quantil (Median) und 0.75-Quantil heissen auch 1., 2. und 3. Quartil, weil sie den Wertebereich in vier gleichgroße Teile teilen: Zwischen Minimum und 0.25-Quantil liegen 25% der Merkmalswerte, zwischen 0.25-Quantil und Median 25%, zwischen Median und 0.75-Quantil 25% und zwischen 0.75-Quantil und Maximum ebenfalls 25%. Ebenso gibt es auch Quintile usw., diese sind aber in der Praxis kaum von Bedeutung. Ein Boxplot kann horizontal wie hier und vertikal dargestellt werden.

```{r boxplot, echo=FALSE, fig.align='center', fig.cap='Boxplot mit Quartilsabstand und Spannweite.', out.width='80%'}
knitr::include_graphics('figs/boxplot.png')
```

Der Boxplot ist eine vereinfachte Darstellung eines Histogramms. Schauen Sie sich dazu bitte Kapitel 4.3.6 von @zimmermann2014 an, besonders Abbildung 4.10. Sehen Sie welcher Boxplot in 4.10b zu welchem Histogramm in 4.10c gehört?

Die Entsprechung können Sie auch in unseren Reisedaten sehen (hier sowohl "distanz" als auch "stationen"):
```{r include=FALSE}
# Paket laden, das für das Einlesen von xlsx gebraucht wird
library("readxl")
# Daten einlesen
reisedat <- read_excel("data/Daten_Distanz_Stationen.xlsx")
# in Zahlen und data.frame umwandeln
reisedat <- as.data.frame(apply(reisedat,2,as.numeric))
```
```{r echo=TRUE, fig.show='hold', out.width='50%'}
# Histogramm "distanz" in km
hist(reisedat$distanz, breaks = seq(0, 55, 5),
     main = "", xlab = "Entfernung (km)", 
     ylab = "absolute Häufigkeit")
# Histogramm "stationen"
hist(reisedat$stationen, breaks = seq(0, 55, 5),
     main = "", xlab = "Anzahl Stationen", 
     ylab = "absolute Häufigkeit")
# Boxplot "distanz" in km
boxplot(reisedat$distanz, range = 0, horizontal = TRUE,
        ylim = c(0,55), xlab = "Entfernung (km)")
# Boxplot "stationen"
boxplot(reisedat$stationen, range = 0, horizontal = TRUE,
        ylim = c(0,55), xlab = "Anzahl Stationen")
```
Sowohl "distanz" als auch "stationen" sind schief verteilt, die zentralen 50% der Verteilung - die "Box" im Boxplot - befinden sich links der Mitte. Es ist wichtig für das Verständnis von Verteilungen in Kapitel \@ref(verteilungen), dass sie den Zusammenhang zwischen Histogramm und Boxplot verstehen!

Nun zu den weiteren Streuungsparametern. Die **Varianz** $s^2$ ist die mittlere ("durchschnittliche") quadrierte Abweichung der Merkmalswerte $x_i\quad\left(i=1, 2, \ldots, x_n\right)$ vom arithmetischen Mittel $\bar x$:
$$s^2=\frac{\sum_{i-1}^{n}\left(x_i-\bar x\right)^2}{n-1}$$

Genau genommen ist das die **korrigierte Varianz**, wo durch $n-1$ geteilt wird und nicht durch $n$ wie man bei einer Mittelung erwarten würde. Das Teilen durch $n-1$ garantiert eine optimale Schätzung der Varianz der Grundgesamtheit anhand der Stichprobe - mehr dazu in der schließenden Statistik. Der Nenner $n-1$ wird **Anzahl Freiheitsgrade** genannt und bezeichnet die Anzahl der Werte in einer Stichprobe, die für die Berechnung des Parameters (hier Varianz) frei zur Verfügung stehen. Im Fall der Varianz ist ein Wert der Stichprobe bereits "belegt" – durch das arithmetische Mittel. Daher reduziert sich die Zahl der Elemente der Stichprobe, die in die Berechnung eingehen um eins.

Die **Standardabweichung** $s$ ist die Quadratwurzel der mittleren quadrierten Abweichung der Merkmalswerte $x_i\quad\left(i=1, 2, \ldots, x_n\right)$ vom arithmetischen Mittel $\bar x$, d.h. die Quadratwurzel der Varianz:
$$s=\sqrt{s^2}=\sqrt{\frac{\sum_{i-1}^{n}\left(x_i-\bar x\right)^2}{n-1}}$$

Die Standardabweichung besitzt die gleiche Einheit wie die Merkmalswerte und ist deshalb einfacher zu interpretieren als die Varianz. Sie drückt die Streuung der Merkmalswerte um den Mittelwert bzw. deren Abweichung vom Mittelwert in einer anschaulichen Größe aus. Je größer die Werte der Standardabweichung sind, desto mehr streuen die Daten.

Der **Variationskoeffizient** $v$ einer Häufigkeitsverteilung mit den Merkmalswerten $x_i\quad\left(i=1, 2, \ldots, x_n\right)$ schließlich ist die Standardabweichung $s$ im Verhältnis zum Mittelwert $\bar x$:
$$v=\frac{s}{\bar x}$$

Der Variationskoeffizient setzt die Streuung der Merkmalswerte in unmittelbare Relation zum arithmetischen Mittel. Dadurch werden unterschiedliche Verteilungen vergleichbar.

Schauen wir uns die Streungsparameter für die Reisedaten mittels R an:

```{r echo=TRUE}
# "distanz" in km
# arithmethisches Mittel
xbar <- mean(reisedat$distanz)
xbar
# Varianz
s2x <- var(reisedat$distanz)
s2x
# Standardabweichung
sx <- sqrt(s2x)
sx
sx <- sd(reisedat$distanz)
sx
# Variationskoeffizient
vx <- sx / xbar
vx
# "stationen"
# arithmethisches Mittel
tbar <- mean(reisedat$stationen)
tbar
# Varianz
s2t <- var(reisedat$stationen)
s2t
# Standardabweichung
st <- sd(reisedat$stationen)
st
# Variationskoeffizient
vt <- st / tbar
vt
```
Die Variable "stationen" hat im Vergleich zu "distanz" eine etwas größere Varianz bei etwas geringerem Mittelwert. Daher ist der Variationskoeffizient größer.

## Schiefe und Wölbung von Häufigkeitsverteilungen

Lesen Sie dazu bitte Kapitel 3.2.5 von @zimmermann2014.

Die **Schiefe** $a_3$ einer Häufigkeitsverteilung von Merkmalswerten $x_1, x_2, \ldots, x_n$ mit dem arithmetischen Mittel $\bar x$ und der Standardabweichung $s$ bezeichnet die Abweichung der Verteilung der Merkmalswerte von der symmetrischen Form:
$$a_3=\frac{\sum_{i=1}^{n}\left(x_i-\bar x\right)^3}{n\cdot s^3}$$

Für eine symmetrische Verteilung gilt:
$$a_3=0\quad \bar x_{mod}=\bar x_{med}=\bar x$$
D.h. Modus, Median und Arithmetisches Mittel sind identisch.

Für eine sogenannte rechtsschiefe (linkssteile) Verteilung gilt:
$$a_3>0\quad \bar x_{mod}<\bar x_{med}<\bar x$$
Für eine linkschiefe (rechtssteile) Verteilung gilt:
$$a_3<0\quad \bar x_{mod}>\bar x_{med}>\bar x$$

Wie wir an Histogramm und Boxplot der Entfernungsdaten bereits gesehen haben sind die Verteilungen der Merkmale "distanz" und "stationen" rechtsschief:

```{r echo=TRUE, warning=FALSE}
# fuer diese Berechnung brauchen wir das Paket "moments"
library(moments)
# "distanz"
# Schiefe
skewness(reisedat$distanz)
# Modus(=7.5) < Median < arithm. Mittelwert
median(reisedat$distanz)
mean(reisedat$distanz)
# "stationen"
# Schiefe
skewness(reisedat$stationen)
# Modus(=7.5) < Median < arithm. Mittelwert
median(reisedat$stationen)
mean(reisedat$stationen)
```

Die **Wölbung** $a_4$ einer Häufigkeitsverteilung von Merkmalswerten $x_1, x_2, \ldots, x_n$ mit dem arithmetischen Mittel $\bar x$ und der Standardabweichung $s$ bestimmt die _Steilheit_ einer Verteilung:
$$a_4=\frac{\sum_{i=1}^{n}\left(x_i-\bar x\right)^4}{n\cdot s^4}-3$$

Die Subtraktion von "-3" dient der Standardisierung auf die sogenannte Normalverteilung, eine symmetrische, glockenförmige Verteilung (s. @zimmermann2014, Kapitel 3.2.5). Mehr zur Normalverteilung in Kapitel \@ref(verteilungen).

Für eine Normalverteilung gilt:
$$a_4=0$$

Für eine spitzere Verteilung als die Normalverteilung gilt:
$$a_4>0$$

Für eine flachere Verteilung als die Normalverteilung gilt:
$$a_4<0$$

Die Verteilungen der Merkmale unserer Reisedaten sind beide spitzer als die Normalverteilung, wobei sie wegen ihrer Rechtsschiefe sowieso nicht mit der Normalverteilung vergleichbar sind:

```{r echo=TRUE}
# Wölbung "distanz"
kurtosis(reisedat$distanz) - 3
# Wölbung "stationen"
kurtosis(reisedat$stationen) - 3
```

